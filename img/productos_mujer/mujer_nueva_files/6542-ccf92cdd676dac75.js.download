!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="2e614da0-3a00-436f-958b-a5f7c7ec265a",e._sentryDebugIdIdentifier="sentry-dbid-2e614da0-3a00-436f-958b-a5f7c7ec265a")}catch(e){}}();var _sentryModuleMetadataGlobal="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};"use strict";_sentryModuleMetadataGlobal._sentryModuleMetadata=_sentryModuleMetadataGlobal._sentryModuleMetadata||{},_sentryModuleMetadataGlobal._sentryModuleMetadata[new _sentryModuleMetadataGlobal.Error().stack]=Object.assign({},_sentryModuleMetadataGlobal._sentryModuleMetadata[new _sentryModuleMetadataGlobal.Error().stack],{"_sentryBundlerPluginAppKey:pica":!0}),(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6542],{82044:function(e,t,n){n.d(t,{l:function(){return k},Z:function(){return g}});var r=n(18421),a=n(98607),i=n(98706),o=n(54268),l=n.n(o),c=n(38666),s=n(67515),d=n(2642),u=n(23289);let f=e=>{let{ratio:t=8.5,className:n,onClick:i}=e,[o,l]=(0,a.useState)(32),[c,d]=(0,a.useState)(32),f=(0,s.n)();return(0,a.useEffect)(()=>{l(f.width*t/100),d(f.width*t/100)},[t,f]),(0,r.jsx)(u.Sn,{className:n,onClick:i,children:(0,r.jsx)("svg",{width:o,height:c,viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{d:"M8 12L16 20L24 12",stroke:"#0A0A0A","stroke-width":"2.13333","stroke-linecap":"round","stroke-linejoin":"round"})})})};var h=n(15712),p=n(48217);let g=a.forwardRef(function(e,t){let{className:n,maskClassName:o,defaultSlot:g,theme:w,expandSlot:m,triggerSlot:b,defaultVisibility:y,modalZIndex:v,onOpenChange:k,closeWithMask:x,onTriggerClick:_,UNSAFEAutoRePosition:M,expandSlotStyle:j,allowScroll:I,initWithOpen:C=!1,openByDefaultSlot:A=!1,showTrigger:L=!0}=e,R=(0,a.useRef)(null),E=(0,a.useRef)(null),Z=(0,a.useRef)(null),[P,S]=(0,a.useState)(C),[W,D]=(0,a.useState)(!1),[U,F]=(0,a.useState)(!1),H=(0,s.n)(),O=(0,i.Z)(()=>{G(R.current),F(!1),D(!1)}),z=(0,i.Z)((e,t)=>{if(R.current&&!U&&(F(!0),G(R.current)),!W&&R.current){var n;null===(n=R.current)||void 0===n||n.style.setProperty("transition-duration",".3s"),D(!0)}if("boolean"==typeof t){S(t),k&&k(t);return}S(e=>(k&&k(!e),!e))});(0,a.useImperativeHandle)(t,()=>({open:()=>z(null,!0),close:()=>z(null,!1),isOpen:P,handleTrigger:z,forceUpdate:O})),(0,c.t)({isDisabled:!!I||!P});let G=(0,i.Z)(e=>{if(!e)return;if("hidden"===y){e.style.cssText="\n        transform: translate3d(0, 100%, 0);\n        visibility: visible;\n      ";return}let t=0;E.current&&(t=E.current.clientHeight+parseInt(getComputedStyle(E.current).marginTop)),e.style.cssText="\n      transform: translate3d(0, calc(".concat(e.clientHeight-t,"px - 5vw), 0);\n      visibility: visible;\n    ")});(0,a.useEffect)(()=>{O()},[H]),(0,a.useEffect)(()=>{let e;if(M&&Z.current)return(e=new MutationObserver(()=>{O()})).observe(Z.current,{subtree:!0,childList:!0,attributes:!0}),()=>{e&&e.disconnect()}},[m]);let N=(0,i.Z)(e=>{e&&(G(e),R.current=e)}),T=(0,i.Z)(e=>{e&&(E.current=e)}),B=b||f;return(0,r.jsx)(d.d,{selector:"body",children:(0,r.jsxs)(a.Fragment,{children:[(0,r.jsx)(u.oQ,{className:l()(o,n),zIndex:v,visible:P,onClick:e=>{x&&x(),z(e)}}),(0,r.jsxs)(u.oA,{zIndex:v,ref:N,className:l()(u.Ap,n,{["".concat(u.Ap,"--open")]:P,["".concat(u.Ap,"--isLight")]:w===h.bY.LIGHT}),children:[L&&(0,r.jsx)(B,{className:"".concat(u.Ap,"__trigger"),onClick:e=>{_&&_(),z(e)}}),(0,r.jsx)(u.Wf,{ref:T,onClick:A?z:p.Z,className:"".concat(u.Ap,"__default-slot"),children:g}),(0,r.jsx)(u.yR,{ref:Z,style:j,className:"".concat(u.Ap,"__expand-slot"),children:m})]})]})})});var w=n(88473),m=n(13404);function b(){let e=(0,w._)(["\n  width: 100%;\n  box-sizing: border-box;\n  min-height: unset;\n  padding: var(--spacing-small) var(--spacing-normal);\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  &:not(.only-expand-slot-mask) {\n    display: flex;\n  }\n  &.only-expand-slot-mask {\n    ",";\n    &.is-visible {\n      background-color: var(--color-colors-blackopacity20);\n    }\n  }\n"]);return b=function(){return e},e}let y=(0,m.ZP)(g).withConfig({componentId:"sc-b82908f6-0"})(b(),e=>{let{allowScroll:t}=e;return t&&'display: "none"'});var v=n(91282);let k=(0,a.memo)((0,a.forwardRef)(function(e,t){let{expandSlot:n,onOpenChange:o,closeWithMask:c,onTriggerClick:s,allowScroll:d=!0,modalZIndex:u=2,maskVisible:f}=e,h=(0,r.jsx)(r.Fragment,{}),p=(0,a.useRef)(null),g=(0,i.Z)(()=>{var e;null===(e=p.current)||void 0===e||e.close()}),w=(0,i.Z)(()=>{var e;null===(e=p.current)||void 0===e||e.open()});return(0,a.useImperativeHandle)(t,()=>({close:g,show:w})),(0,r.jsx)(y,{ref:p,maskClassName:l()("only-expand-slot-mask",{"is-visible":f}),allowScroll:d,defaultVisibility:"hidden",defaultSlot:h,expandSlot:n,triggerSlot:v.Z,onOpenChange:o,closeWithMask:c,onTriggerClick:s,modalZIndex:u})}))},23289:function(e,t,n){n.d(t,{Ap:function(){return h},Sn:function(){return w},Wf:function(){return m},oA:function(){return g},oQ:function(){return p},yR:function(){return b}});var r=n(88473),a=n(13404),i=n(36512);function o(){let e=(0,r._)(["\n    z-index: ",";\n  "]);return o=function(){return e},e}function l(){let e=(0,r._)(["\n  display: ",";\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n\n  ","\n"]);return l=function(){return e},e}function c(){let e=(0,r._)(["\n    display: block;\n    z-index: ",";\n  "]);return c=function(){return e},e}function s(){let e=(0,r._)(["\n  position: fixed;\n  visibility: hidden;\n  bottom: 0;\n  background-color: var(--color-colors-bgoverlay);\n  // TODO: 因为是 fixed，所以宽度计算可能会有问题，待讨论\n  /* width: 100%; */\n  min-height: 10vh;\n  border-top-left-radius: 6.4vw;\n  border-top-right-radius: 6.4vw;\n  padding: 4.26vw 4.26vw 5vw 4.26vw;\n  color: black;\n  transition-property: all;\n  transition-timing-function: ease; // cubic-bezier(0, 0.59, 0.25, 1.26);\n\n  display: none;\n\n  // 职业照只需要白色背景\n  &.","--isLight {\n    background-color: #fff;\n  }\n\n  ","\n\n  &.","--open {\n    transform: translate3d(0, 5vw, 0) !important;\n\n    .","__trigger {\n      transform: rotate(0deg);\n    }\n    .","__default-slot {\n      opacity: 0;\n      z-index: 0;\n    }\n    .","__expand-slot {\n      opacity: 1;\n      z-index: 1;\n    }\n  }\n\n  &:after {\n    content: '';\n  }\n"]);return s=function(){return e},e}function d(){let e=(0,r._)(["\n  width: ","vw;\n  height: ","vw;\n  outline: none;\n  appearance: none;\n  -webkit-appearance: none;\n  -webkit-tap-highlight-color: transparent;\n  transform: rotate(-180deg);\n  &:active {\n    background: none;\n  }\n"]);return d=function(){return e},e}function u(){let e=(0,r._)(["\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100vw;\n  box-sizing: border-box;\n  padding: 0 4.26vw 0 4.26vw;\n  margin-top: 12.76vw;\n  transition: opacity 0.3s;\n"]);return u=function(){return e},e}function f(){let e=(0,r._)(["\n  position: relative;\n  opacity: 0;\n  transition: opacity 0.3s;\n"]);return f=function(){return e},e}let h="pica-mobile-foot-drawer",p=a.ZP.div.withConfig({componentId:"sc-87dfd77d-0"})(l(),e=>{let{visible:t}=e;return t?"block":"none"},i.BC.mobile(o(),e=>{let{zIndex:t}=e;return t})),g=a.ZP.div.withConfig({componentId:"sc-87dfd77d-1"})(s(),h,i.BC.mobile(c(),e=>{let{zIndex:t}=e;return t}),h,h,h,h),w=a.ZP.div.withConfig({componentId:"sc-87dfd77d-2"})(d(),8.5,8.5),m=a.ZP.div.withConfig({componentId:"sc-87dfd77d-3"})(u()),b=a.ZP.div.withConfig({componentId:"sc-87dfd77d-4"})(f())},10449:function(e,t,n){n.d(t,{L7:function(){return s},qL:function(){return g},Od:function(){return f},r5:function(){return d},Mf:function(){return h},Up:function(){return u}});let r=null;class a{async createWorker(){if(!r){let[e,t]=await Promise.all([fetch("https://static.pica-ai.com/js/ffmpeg/capture.wasm").then(e=>{if(!e.ok)throw Error("Failed to fetch capture.wasm");return e.arrayBuffer()}),fetch("https://static.pica-ai.com/js/ffmpeg/capture.js").then(e=>{if(!e.ok)throw Error("Failed to fetch capture.js");return e.text()})]),n=function(e){let t="",n=new Uint8Array(e),r=n.byteLength;for(let e=0;e<r;e++)t+=String.fromCharCode(n[e]);return btoa(t)}(e);t=t.replace(/WASM_STRING/,'"'.concat(n,'"')),r=new Blob([t],{type:"application/javascript"})}let e=URL.createObjectURL(r),t=this;this.worker=new Worker(e),await new Promise(e=>{t.worker.onmessage=function(n){if("init"==n.data.type&&e(),"capture"==n.data.type){console.info("self.callback =>",t.callback);let{imageDataBuffer:e,width:r,height:a}=n.data.data,i=document.createElement("canvas"),o=i.getContext("2d");i.width=r,i.height=a;let l=new ImageData(e,r,a);o.putImageData(l,0,0,0,0,r,a),t.callback(i.toDataURL("image/jpeg"),n.data.data)}}}),this.loaded=!0}load(){return this.createWorker()}capture(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:i;if(!this.worker)throw Error("WebCapture instance not loaded");this.callback=n,this.worker.postMessage({type:"capture",data:{file:e,timeStamp:t}})}constructor(){this.worker=null,this.loaded=!1,this.callback=null}}function i(){arguments.length>0&&void 0!==arguments[0]&&arguments[0],arguments.length>1&&arguments[1]}new a;var o=n(95839);let l=e=>{for(var t=atob(e.split(",")[1]),n=e.split(",")[0].split(":")[1].split(";")[0],r=new ArrayBuffer(t.length),a=new Uint8Array(r),i=0;i<t.length;i++)a[i]=t.charCodeAt(i);return new Blob([r],{type:n})},c=async(e,t)=>{let n=new OffscreenCanvas(e.width,e.height),r=n.getContext("2d");await new Promise(t=>{requestAnimationFrame(()=>{r.drawImage(e,0,0),requestAnimationFrame(t)})}),t&&await new Promise(a=>{requestAnimationFrame(()=>{t({image:e,canvas:n,ctx:r}),requestAnimationFrame(a)})});let a=await n.convertToBlob({type:"image/webp",quality:.9});return{blob:a,canvas:n}},s=1024,d=async e=>{let{file:t,maxSize:n=2048,shouldTryCatch:r,needCreateObjectURL:a}=e;return u({file:t,resizeImage:e=>{let{image:t,canvas:r,ctx:a}=e,i=t.width/t.height,o=Math.max(t.width,t.height);o>n&&(i>1?(r.width=n,r.height=n/i):(r.width=n*i,r.height=n),null==a||a.clearRect(0,0,r.width,r.height),null==a||a.drawImage(t,0,0,r.width,r.height))},shouldTryCatch:r,needCreateObjectURL:a})},u=e=>{let{file:t,resizeImage:n,fileName:r,shouldTryCatch:a,needCreateObjectURL:i}=e,o=new window.Image;if("string"==typeof t)return o.src=t,new Promise(e=>{o.onload=()=>{e({formData:new FormData,ratio:o.naturalWidth/o.naturalHeight,src:o.src,imgWidth:o.naturalWidth,imgHeight:o.naturalHeight,finalImgWidth:o.naturalWidth,finalImgHeight:o.naturalHeight})},o.onerror=()=>{a&&e(null)}});let l=URL.createObjectURL(t);return o.src=l,new Promise(e=>{o.onload=async()=>{try{let{blob:t,canvas:a}=await c(o,n),l=o.width/o.height,s=new File([t],o.name,{type:"image/jpeg",lastModified:new Date().getTime()}),d=new FormData;d.append(r||"image",s),e({formData:d,ratio:l,src:i?URL.createObjectURL(s):o.src,imgWidth:o.width,imgHeight:o.height,finalImgWidth:a.width,finalImgHeight:a.height}),a.width=0,a.height=0}catch(t){a&&e(null)}finally{URL.revokeObjectURL(l),o.src=""}},o.onerror=()=>{a&&e(null)}})},f=async e=>{{let t=n(72738);if(/hei[cf]/.test(e.type))try{let n=await t({blob:e});return n}catch(e){console.info("converImg heic2any fail",e)}}return e},h=function(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];return new Promise((n,r)=>{let a=document.createElement("video");a.src=URL.createObjectURL(e),console.info("videoElement create",a),a.onloadedmetadata=a.onloadeddata=()=>{console.info("videoElement onloadedmetadata call",a.duration),t?n(Math.ceil(1e3*a.duration)):n(Math.ceil(a.duration))},a.onerror=()=>{r("Failed to load video metadata")}})},p=async function(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1],[]},g=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.Z,r=!0;try{await a.prototype.load()}catch(e){console.info("load fail",e),r=!1}if(console.info("ffmpegEnable: ",r),!r)return await p(e,t);try{console.info("get duration start");let r=await h(e);console.info("get duration: ",r),n(r);let i=Math.floor(r/t);console.info("get captureGapTime: ",i);let o=Array.from({length:t}).map((t,n)=>{let r=new a;return console.info("webCapture: begin",r),r.load().then(()=>new Promise((t,a)=>{r.capture(e,n*i,e=>{e?(console.info("resolve url success",e),t(l(e))):(console.info("reject with url empty",e),a())})}))}),c=await Promise.allSettled(o);return c.filter(e=>"fulfilled"===e.status).map(e=>e.value)}catch(n){return console.info("capture with ffmpeg fail",n),await p(e,t)}}},2642:function(e,t,n){n.d(t,{d:function(){return i}});var r=n(98607),a=n(44990);let i=e=>{let{selector:t,children:n}=e,[i,o]=(0,r.useState)(null);return((0,r.useEffect)(()=>{o(document.querySelector(t))},[]),i)?(0,a.createPortal)(n,i):null}},91282:function(e,t,n){var r=n(18421);n(98607),t.Z=e=>(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:37,height:12,fill:"none",...e,children:(0,r.jsx)("path",{stroke:"#DFE4E7",strokeLinecap:"round",strokeWidth:4,d:"m2.5 2.989 14.807 4.627a4 4 0 0 0 2.386 0L34.5 2.989"})})}}]);